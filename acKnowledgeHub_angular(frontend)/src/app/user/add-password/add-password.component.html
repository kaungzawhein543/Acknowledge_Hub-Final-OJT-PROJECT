<div class="container py-10 bg-gray-100 rounded-lg" style="height: 100%;" @cardAnimation>
    <div class="card flex justify-center mt-16">
        <div class="w-full max-w-lg">
            <div class="bg-white shadow-2xl rounded-lg" style="min-height: 200px;">
                <div class="text-white text-center py-4 rounded-t-lg" style="background-color: #1b4980;">
                    <h2 class="text-2xl font-bold">Change Password</h2>
                </div>
                <div class="p-6">
                    <form (ngSubmit)="addPassword()" #changePasswordForm="ngForm" class="my-2 space-y-6">
                        
                        <div *ngIf="successMessage" class="bg-green-100 text-green-700 p-4 rounded mb-4 flex items-center">
                            <i class="fas fa-check-circle text-green-500 mr-2"></i>{{ successMessage }}
                        </div>
                        
                        <div *ngIf="errorMessage" class="bg-red-100 text-red-700 p-4 rounded mb-4 flex items-center">
                            <i class="fas fa-exclamation-circle text-red-500 mr-2"></i>{{ errorMessage }}
                        </div>

                        <div class="card mb-4">
                            <label for="oldPassword" class="block text-gray-700 font-semibold mb-2">Password</label>
                            <div class="relative">
                                <input [type]="showPassword ? 'text' : 'password'" id="oldPassword" name="oldPassword"
                                    [(ngModel)]="password" required minlength="6"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:border-blue-500"
                                    #oldPasswordInput="ngModel" />
                                <button type="button" (click)="togglePasswordVisibility()"
                                    class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <i *ngIf="showPassword" class="fa-regular fa-eye"></i>
                                    <i *ngIf="!showPassword" class="fa-regular fa-eye-slash"></i>
                                </button>
                            </div>
                            <div *ngIf="oldPasswordInput.errors?.['required'] && oldPasswordInput.touched"
                                class="text-red-600 text-sm mt-2">
                                <i class="fas fa-exclamation-circle mr-1"></i>Password is required.
                            </div>
                            <div *ngIf="oldPasswordInput.errors?.['minlength'] && oldPasswordInput.touched"
                                class="text-red-600 text-sm mt-2">  
                                <i class="fas fa-exclamation-circle mr-1"></i>Password must be at least 6 characters long.
                            </div>
                        </div>

                        <div class="card mb-4">
                            <label for="newPassword" class="block text-gray-700 font-semibold mb-2">Confirm Password</label>
                            <div class="relative">
                                <input [type]="showConfirmPassword ? 'text' : 'password'" id="newPassword" name="newPassword"
                                    [(ngModel)]="confirmPassword" required minlength="6"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:border-blue-500"
                                    #newPasswordInput="ngModel" />
                                <button type="button" (click)="toggleConfirmPasswordVisibility()"
                                    class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <i *ngIf="showConfirmPassword" class="fa-regular fa-eye"></i>
                                    <i *ngIf="!showConfirmPassword" class="fa-regular fa-eye-slash"></i>
                                </button>
                            </div>
                            <div *ngIf="newPasswordInput.errors?.['required'] && newPasswordInput.touched"
                                class="text-red-600 text-sm mt-2">
                                <i class="fas fa-exclamation-circle mr-1"></i>Confirm password is required.
                            </div>
                            <div *ngIf="!newPasswordInput.errors?.['required'] && newPasswordInput.touched">
                                <div *ngIf="confirmPassword !== password && newPasswordInput.touched" class="text-red-600 text-sm mt-2">
                                    <i class="fas fa-exclamation-circle mr-1"></i>Confirm password must match the password.
                                </div> 
                            </div>
                        </div>
                        <br>

                        <div class="card flex space-x-4">
                            <!-- Reset Button -->
                            <button type="reset"
                                class="w-full bg-gray-300 text-gray-700 font-semibold py-3 rounded hover:bg-gray-400 transition duration-200 flex items-center justify-center">
                                RESET
                            </button>

                            <!-- Submit Button -->
                            <button type="submit"
                                class="w-full bg-[#1b4980] text-white font-semibold py-3 rounded hover:bg-blue-700 transition duration-200 flex items-center justify-center"
                                [disabled]="changePasswordForm.invalid || confirmPassword !== password">
                                CHANGE PASSWORD
                            </button>
                        </div>
                    </form>

                    <a routerLink="/acknowledgeHub/login" class="card block text-center text-blue-500 mt-6 hover:underline">
                        <i class="fas fa-arrow-left mr-2"></i>Back to Login
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
