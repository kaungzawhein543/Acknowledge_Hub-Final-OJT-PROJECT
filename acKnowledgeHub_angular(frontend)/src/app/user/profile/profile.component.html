<div class="profile-container" @cardAnimation>
  <!-- Profile Banner -->
  <div class="profile-banner">
  </div>

  <!-- Profile Card -->
  <div class="card profile-card">
    <img [src]="oldPhotoUrl" alt="User Profile" class="profile-image" />

    <div class="card-info">
      <h3>{{ profile?.name }}</h3>
      <p class="position">{{ profile?.position }}</p>
      <div class="profile-actions">
        <button class="update-photo-button"  (click)="openModal()">Update Photo</button>
        <button class="change-password-button" (click)="openChangePasswordModal()">Change Password</button>
      </div>
    </div>
  </div>

  <!-- Profile Details Section with Side-by-Side Layout -->
  <div class="card profile-details">
    <h4>Profile</h4>
    <div class="details-row">
      <div class="details-column">
        <h5>Information Details</h5>
        <p><strong>ID:</strong> {{ profile?.companyStaffId }}</p>
        <p><strong>Name:</strong> {{ profile?.name }}</p>
        <p><strong>Email:</strong> {{ profile?.email }}</p>
      </div>
      <div class="details-column">
        <h5>Company Information</h5>
        <p><strong>Company:</strong> {{ profile?.company }}</p>
        <p><strong>Department:</strong> {{ profile?.department }}</p>
      </div>
    </div>
    <br>
    <!-- Monthly Announcement Count Section -->
    <div *ngIf="profile?.monthlyCount && getMonths(profile?.monthlyCount).length > 0" class="card announcement-card">
      <h5 class="announcement-card-header">Announcement Count</h5>
      
      <!-- Dropdown for selecting month -->
      <div class="month-dropdown">
        <label for="monthSelect">Select Month:</label>
        <select id="monthSelect" (change)="onMonthChange($event)">
          <option *ngFor="let month of getMonths(profile?.monthlyCount)" [value]="month">
            {{ month }}
          </option>
        </select>
      </div>
      
      <!-- Display the count for the selected month -->
      <div class="month-count" >
        <p *ngIf="selectedMonthCount != 0"><strong>You have  {{ selectedMonthCount ?? 0 }} announcements in {{selectedMonth}} </strong> </p>
      </div>

       <!-- Show "No data available" message if there is no data -->
    <p *ngIf="selectedMonthCount === 0">
      <strong>No data available for {{ selectedMonth }}</strong>
    </p>
    </div>
    <br>
  </div>

  <!-- Preview Modal -->
  <div class="preview-modal" *ngIf="showModal">
    <div class="modal-content">
      <span class="close-button" (click)="closeModal()">&times;</span>
      <div *ngIf="newPhotoUrl">
        <img [src]="newPhotoUrl" alt="New Photo Preview" class="preview-image" />
      </div>
      <div *ngIf="!newPhotoUrl">
        <img [src]="oldPhotoUrl" alt="Old Photo" class="preview-image" />
      </div>
      <div class="file-input-wrapper">
        <label class="custom-file-upload">
          Choose File
          <input type="file" accept=".jpg, .jpeg, .png" (change)="onFileChange($event)" />
        </label>
      </div>
      <button (click)="uploadPhoto()">Upload Photo</button>
    </div>
  </div>


 <!-- Change Password Modal -->
 <div class="card change-password-modal" *ngIf="showChangePasswordModal">
  <div class="modal-content">
    <span class="close-button" (click)="closeChangePasswordModal()">&times;</span>
    
    <h3 class="text-4xl font-semibold medium text-gray-800 text-center mb-6" style="color: #1b4980;">Change Password</h3>
    
    <div *ngIf="changePasswordMessage" class="error-message">
      {{ changePasswordMessage }}
    </div>
    <div *ngIf="successMessage" class="success-message">
      {{ successMessage }}
    </div>
    <br>
    <form (ngSubmit)="changePassword()">
      <input type="password" id="oldPassword" [(ngModel)]="oldPassword" name="oldPassword" placeholder="Old Password" required />
      <input type="password" id="newPassword" [(ngModel)]="newPassword" name="newPassword" placeholder="New Password" required />

      <button type="submit">Change Password</button>
      
    </form>
    
  </div>
</div>
</div>
